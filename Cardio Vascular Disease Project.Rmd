---
title: "Cardio Vascular Disease Project"
author: "Team 1"
date: "`r Sys.Date()`"
output:
  html_document:
    code_folding: hide
    number_sections: false
    toc: yes
    toc_depth: 3
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '3'
---

```{r init, include=F}
library(ezids)
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = F, results = "hide", message = F)
options(scientific=T, digits = 3) 
```
## Chapter 1: Introudction to Cardiovascular Diseases (CVDs)

<<<<<<< Updated upstream
## Summary of the dataset

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.
=======
# 1.1 Basic Information About Cardiovascular Diseases (CVDs)

Cardiovascular Disease is a general name for numerous types of diseases including heart attack, stroke, and heart failure. In 2019 an estimated 17.9 million people died from Cardiovascular Diseases and 85% were due to heart attack and stroke.

# 1.2 Reasons of Choosing Cardiovascular Disease.
As living standards are improving over the past few decades, having a healthy lifestyle and avoiding serious illnesses have become people’s priorities and Cardiovascular diseases are the leading cause of death globally our group is interested in finding out some facts about Cardiovascular Disease such as what exactly Cardiovascular Diseases are. What are some factors that are correlate to Cardiovascular Diseases, among those factors what have the strongest correlation to Cardiovascular Diseases? And would a healthy lifestyle help to prevent people from having cardiovascular disease? Therefore, our group choose this dataset about Cardiovascular Diseases

## 


 
>>>>>>> Stashed changes

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
4.
# Chapter 4: Continuous Variables EDA to Cardiovascular Diseases (CVDs)

After a brief overview of the dataset, it tells that there are 3 continuous variables, age, height and weight.

## 4.1 KDE plot of continuous variables

```{r init, include=F}
library(ezids)
library(ggplot2)
library(dplyr)
library(ggpubr)
```


```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = F, results = "hide", message = F)
options(scientific=T, digits = 3) 
```



```{r}

CVD <- data.frame(read.csv("cardio_train.csv", sep=";"))
View(CVD)


```


```{r}

str(CVD)

```

```{r, results="markup"}

CVD$cardio <- factor(CVD$cardio)


```

```{r}
cols<-c("0"="green","1"="blue")

```







```{r}
age_kdeplot <- ggplot(data = CVD, aes(x = age, color =cardio)) + 
            geom_density(aes(fill = cardio), alpha = 0.8) + 
             scale_fill_manual(values =cols) +
              labs(title="KDEplot for age") +
               labs(x="age", y="density") +
                theme(legend.position="top")
age_kdeplot


```


```{r}
age_kdeplot <- ggplot(data = CVD, aes(x = height, color = cardio)) + 
            geom_density(aes(fill = cardio), alpha = 0.8) + 
             scale_fill_manual(values =cols) +
              labs(title="KDEplot for height") +
               labs(x="height", y="density") +
                theme(legend.position="top")
age_kdeplot


```



```{r}
age_kdeplot <- ggplot(data = CVD, aes(x = weight, color = cardio)) + 
            geom_density(aes(fill = cardio), alpha = 0.8) + 
             scale_fill_manual(values= cols) +
              labs(title="KDEplot for weight") +
               labs(x="weight", y="density") +
                theme(legend.position="top")
age_kdeplot


```




## 4.2 Logistic regression

The logit model is often used for classification and predictive analytics. Logistic regression estimates the probability of an event occurring, such as voted or didn’t vote, based on a given dataset of independent variables. Since the outcome is a probability, the dependent variable is bounded between 0 and 1(binary outcome). In this case, "cardio"  is the binary outcome; as s result, we choose logistic regression to predict.


```{r}


lm1 <- glm(cardio~age, family = binomial(link = "logit"), data = CVD)
lm2 <- glm(cardio~age + height, family = binomial(link = "logit"), data = CVD)
lm3 <- glm(cardio~height + weight, family = binomial(link = "logit"), data = CVD)
anovat <- anova(lm1,lm2,lm3, test="LRT")
anovat

```

As it is shown above, model 2 is better than model 1 and model 3. In addition, model 2 is at 99% significant level.



## 4.3 AUC and ROC Curve

We can use AUC and ROC to measure model 2. AUC (Area Under The Curve) - ROC (Receiver Operating Characteristics) curve is a performance measurement for the classification problems at various threshold settings. ROC is a probability curve and AUC represents the degree or measure of separability. It tells how much the model is capable of distinguishing between classes. Higher the AUC, the better the model is at predicting 0 classes as 0 and 1 classes as 1. For summarize, the Higher the AUC, the better the model is.


```{r}
prob <- predict(lm2,CVD, type = c("response"))
CVD$prob <- prob
library(pROC)
g<- roc(cardio~prob, data = CVD)
plot(g, main = "ROC curve of model 2")
auc(CVD$cardio, prob)
```
The AUC value is 0.636. As 0.636 is much less than 1, this model is not good enough.


Below is the summary of model 2.

```{r fitmodel,results=TRUE}
xkabledply(lm2, title="summary of model 2")
```




In the 3 continuous variables, `cardio` has positive coefficients with`age` and `height` . It means when we have a customer with older `age` and higher `height`, he has more probabilities to have Cardio Vascular Disease. And `weight` is not significant influence factor to customer `cardio` rates in 3 continuous variables.


`